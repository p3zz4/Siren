!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();e.Siren=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=null,this.ctx=null,this.playPauseBtn=null,this.rightPanel=null,this.bottomPanel=null,this.audio=null,this.sources=[],this.analyser=null,this.requestID=null}return i(t,[{key:"init",value:function(){this.canvas=this.initCanvas(),this.ctx=this.canvas.getContext("2d"),this.playPauseBtn=this.initPlayPauseBtn(),this.rightPanel=this.initRightPanel(),this.bottomPanel=this.initBottomPanel(),this.audio=this.initAudio(),this.initVisualizer()}},{key:"initPlayPauseBtn",value:function(){var t=this,e=document.createElement("div");document.body.appendChild(e),e.classList.add("playPauseBtn");var n=document.createElement("span");return e.appendChild(n),e.span=n,n.innerHTML="▶️",n.addEventListener("click",function(){0===t.audio.childElementCount&&t.playFirstTrack(),"⏸"===n.innerHTML?t.audio.pause():t.audio.play()}),e}},{key:"initBottomPanel",value:function(){var t=this,e=document.createElement("div");document.body.appendChild(e),e.classList.add("bottomPanel");var n=document.createElement("div");e.appendChild(n),n.classList.add("controls");var i=document.createElement("span");n.appendChild(i),i.classList.add("playNextTrackBtn"),i.innerHTML="⏮",i.addEventListener("click",function(){t.playPreviousTrack()});var a=document.createElement("span");return n.appendChild(a),a.classList.add("playPreviousTrackBtn"),a.innerHTML="⏭",a.addEventListener("click",function(){t.playNextTrack()}),e}},{key:"initRightPanel",value:function(){var t=this,e=document.createElement("div");document.body.appendChild(e),e.classList.add("rightPanel");var n=document.createElement("input");return e.appendChild(n),n.type="file",n.accept=".mp3",n.multiple=!0,n.addEventListener("change",function(e){[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n.files)).map(function(t){return t.name.slice(0,-4)}).forEach(function(e){t.addSrcToQueue("../data/music/"+e+".mp3")})}),e}},{key:"initCanvas",value:function(){var t=document.createElement("canvas");return document.body.appendChild(t),t.classList.add("canvas"),t.width=window.innerWidth,t.height=window.innerHeight,window.addEventListener("resize",function(){t.width=window.innerWidth,t.height=window.innerHeight}),t}},{key:"initAudio",value:function(){var t=this,e=document.createElement("audio");return this.bottomPanel.appendChild(e),e.classList.add("audio"),e.controls="contols",e.preload="auto",e.addEventListener("play",function(e){t.playPauseBtn.span.innerHTML="⏸",t.runVisualizer()}),e.addEventListener("pause",function(e){t.playPauseBtn.span.innerHTML="▶️",t.stopVisualizer()}),e}},{key:"addSrcToQueue",value:function(t){var e=document.createElement("source");e.type="audio/mpeg",e.src=t,this.sources.push(e)}},{key:"playNextTrack",value:function(){this.audio.pause();var t=this.sources.shift();this.sources.push(t),this.audio.innerHTML="",this.audio.appendChild(this.sources[0]),this.audio.load(),this.audio.play()}},{key:"playPreviousTrack",value:function(){this.audio.pause();var t=this.sources.pop();this.sources.unshift(t),this.audio.innerHTML="",this.audio.appendChild(this.sources[0]),this.audio.load(),this.audio.play()}},{key:"playFirstTrack",value:function(){this.audio.pause(),this.audio.appendChild(this.sources[0]),this.audio.load(),this.audio.play()}},{key:"initVisualizer",value:function(){var t=new AudioContext;this.analyser=t.createAnalyser(),t.createMediaElementSource(this.audio).connect(this.analyser),this.analyser.connect(t.destination)}},{key:"updateVisualizer",value:function(){var t=this;requestAnimationFrame(function(e){return t.updateVisualizer()});var e=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(e),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#0DDEFF";for(var n=this.canvas.width/3>=1024?this.canvas.width/3:1023,i=0;i<n;i++){var a=3*i,s=1.5*-e[i];this.ctx.fillRect(a,this.canvas.height,2,s)}}},{key:"runVisualizer",value:function(){var t=this;this.requestID=requestAnimationFrame(function(e){return t.updateVisualizer()})}},{key:"stopVisualizer",value:function(){cancelAnimationFrame(this.requestID)}},{key:"log",value:function(){console.log(this.playPauseBtn,this.rightPanel,this.bottomPanel,this.playPauseBtn,this.canvas,this.ctx,this.audio,this.sources)}}]),t}()},function(t,e,n){"use strict";(new(n(0).Siren)).init()}]);
//# sourceMappingURL=siren.bundle.js.map