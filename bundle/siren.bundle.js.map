{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/siren.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","Siren","_classCallCheck","this","canvas","ctx","playPauseBtn","rightPanel","bottomPanel","audio","sources","analyser","requestID","initCanvas","getContext","initPlayPauseBtn","initRightPanel","initBottomPanel","initAudio","initVisualizer","_this","document","createElement","body","appendChild","classList","add","span","innerHTML","addEventListener","childElementCount","playFirstTrack","pause","play","_this2","controls","playPreviousTrackBtn","playPreviousTrack","playNextTrackBtn","playNextTrack","_this3","loader","type","accept","multiple","_","concat","_toConsumableArray","files","map","file","slice","forEach","addSrcToQueue","width","window","innerWidth","height","innerHeight","_this4","preload","runVisualizer","stopVisualizer","src","source","push","tmp","shift","load","pop","unshift","context","AudioContext","createAnalyser","createMediaElementSource","connect","destination","_this5","requestAnimationFrame","updateVisualizer","fbcArray","Uint8Array","frequencyBinCount","getByteFrequencyData","clearRect","fillStyle","NumberOfBars","barWidth","barX","barHeight","fillRect","_this6","cancelAnimationFrame","console","log","init"],"mappings":"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","file":"siren.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","export class Siren {\n        constructor() {\n                this.canvas = null;\n                this.ctx = null;\n                this.playPauseBtn = null;\n                this.rightPanel = null;\n                this.bottomPanel = null;\n                this.audio = null;\n                this.sources = [];\n                this.analyser = null;\n                this.requestID = null;\n        }\n        init() {\n                this.canvas = this.initCanvas();\n                this.ctx = this.canvas.getContext(\"2d\");\n                this.playPauseBtn = this.initPlayPauseBtn();\n                this.rightPanel = this.initRightPanel();\n                this.bottomPanel = this.initBottomPanel();\n                this.audio = this.initAudio();\n                this.initVisualizer();\n        }\n        initPlayPauseBtn() {\n                const playPauseBtn = document.createElement(\"div\");\n                document.body.appendChild(playPauseBtn);\n                playPauseBtn.classList.add(\"playPauseBtn\");\n\n                const span = document.createElement(\"span\");\n                playPauseBtn.appendChild(span);\n                playPauseBtn.span = span;\n                span.innerHTML = \"▶️\";\n                span.addEventListener(\"click\", () => {\n                        if (this.audio.childElementCount === 0) {\n                                this.playFirstTrack();\n                        }\n                        if (span.innerHTML === \"⏸\") {\n                                this.audio.pause();\n                        } else {\n                                this.audio.play();\n                        }\n                });\n                return playPauseBtn;\n        }\n        initBottomPanel() {\n                const bottomPanel = document.createElement(\"div\");\n                document.body.appendChild(bottomPanel);\n                bottomPanel.classList.add(\"bottomPanel\");\n\n                const controls = document.createElement(\"div\");\n                bottomPanel.appendChild(controls);\n                controls.classList.add(\"controls\");\n\n                const playPreviousTrackBtn = document.createElement(\"span\");\n                controls.appendChild(playPreviousTrackBtn);\n                playPreviousTrackBtn.classList.add(\"playNextTrackBtn\");\n                playPreviousTrackBtn.innerHTML = \"⏮\";\n                playPreviousTrackBtn.addEventListener(\"click\", () => {\n                        this.playPreviousTrack();\n                });\n\n                const playNextTrackBtn = document.createElement(\"span\");\n                controls.appendChild(playNextTrackBtn);\n                playNextTrackBtn.classList.add(\"playPreviousTrackBtn\");\n                playNextTrackBtn.innerHTML = \"⏭\";\n                playNextTrackBtn.addEventListener(\"click\", () => {\n                        this.playNextTrack();\n                });\n\n                return bottomPanel;\n        }\n        initRightPanel() {\n                const rightPanel = document.createElement(\"div\");\n                document.body.appendChild(rightPanel);\n                rightPanel.classList.add(\"rightPanel\");\n\n                const loader = document.createElement(\"input\");\n                rightPanel.appendChild(loader);\n                loader.type = \"file\";\n                loader.accept = \".mp3\"\n                loader.multiple = true;\n                loader.addEventListener(\"change\", _ => {\n                        [...loader.files].map((file) => file.name.slice(0, -4)).forEach(name => {\n                                this.addSrcToQueue(`../data/music/${name}.mp3`);\n                        });\n                });\n\n\n\n\n                return rightPanel;\n        }\n        initCanvas() {\n                const canvas = document.createElement(\"canvas\");\n                document.body.appendChild(canvas);\n                canvas.classList.add(\"canvas\");\n                canvas.width = window.innerWidth;\n                canvas.height = window.innerHeight;\n                window.addEventListener(\"resize\", () => {\n                        canvas.width = window.innerWidth;\n                        canvas.height = window.innerHeight;\n                })\n                return canvas;\n        }\n        initAudio() {\n                const audio = document.createElement(\"audio\");\n                this.bottomPanel.appendChild(audio);\n                audio.classList.add(\"audio\");\n                audio.controls = \"contols\";\n                audio.preload = \"auto\";\n                audio.addEventListener(\"play\", _ => {\n                        this.playPauseBtn.span.innerHTML = \"⏸\";\n                        this.runVisualizer();\n                });\n                audio.addEventListener(\"pause\", _ => {\n                        this.playPauseBtn.span.innerHTML = \"▶️\";\n                        this.stopVisualizer();\n                });\n\n                return audio;\n        }\n        addSrcToQueue(src) {\n                const source = document.createElement(\"source\");\n                source.type = \"audio/mpeg\";\n                source.src = src;\n                this.sources.push(source);\n        }\n        playNextTrack() {\n                this.audio.pause();\n                const tmp = this.sources.shift();\n                this.sources.push(tmp);\n                this.audio.innerHTML = \"\";\n                this.audio.appendChild(this.sources[0]);\n                this.audio.load();\n                this.audio.play();\n        }\n        playPreviousTrack() {\n                this.audio.pause();\n                const tmp = this.sources.pop();\n                this.sources.unshift(tmp);\n                this.audio.innerHTML = \"\";\n                this.audio.appendChild(this.sources[0]);\n                this.audio.load();\n                this.audio.play();\n        }\n        playFirstTrack() {\n                this.audio.pause();\n                this.audio.appendChild(this.sources[0]);\n                this.audio.load();\n                this.audio.play();\n        }\n        initVisualizer() {\n                const context = new AudioContext();\n                this.analyser = context.createAnalyser();\n                const source = context.createMediaElementSource(this.audio);\n                source.connect(this.analyser);\n                this.analyser.connect(context.destination);\n                //this.updateVisualizer();\n\n        }\n        updateVisualizer() {\n                requestAnimationFrame(_ => this.updateVisualizer());\n                const fbcArray = new Uint8Array(this.analyser.frequencyBinCount);\n                this.analyser.getByteFrequencyData(fbcArray);\n                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n                this.ctx.fillStyle = '#0DDEFF'; // Color of the bars\n                const barWidth = 2;\n                const gap = 1;\n                const barStep = barWidth + gap;\n                const NumberOfBars = (this.canvas.width / barStep >= 1024) ? this.canvas.width / barStep : 1023;\n                for (let i = 0; i < NumberOfBars; i++) {\n                        const barX = i * barStep;\n                        const barHeight = -(fbcArray[i])*1.5;\n                        this.ctx.fillRect(barX, this.canvas.height, barWidth, barHeight);\n                }\n        }\n        runVisualizer() {\n                this.requestID = requestAnimationFrame(_ => this.updateVisualizer());\n        }\n        stopVisualizer() {\n                cancelAnimationFrame(this.requestID);\n        }\n        log() {\n                console.log(this.playPauseBtn, this.rightPanel, this.bottomPanel, this.playPauseBtn, this.canvas, this.ctx, this.audio, this.sources);\n        }\n\n}","import {Siren} from \"./siren\";\n\nconst siren = new Siren();\nsiren.init();\n\n"],"sourceRoot":""}